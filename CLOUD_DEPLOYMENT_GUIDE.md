
# Twinsight äº‘éƒ¨ç½²æŒ‡å—

> **æœ€åæ›´æ–°**: 2024-12-30  
> **ç‰ˆæœ¬**: 2.0 - å¢è¡¥ n8nã€Open WebUI ç­‰ AI/IoT æœåŠ¡

---

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¶æ„åˆ†æ](#-é¡¹ç›®æ¶æ„åˆ†æ)
- [æ•°æ®è¿ç§»è¯´æ˜](#-é‡è¦æ•°æ®è¿ç§»è¯´æ˜)
- [éƒ¨ç½²ç­–ç•¥é€‰æ‹©](#-éƒ¨ç½²ç­–ç•¥é€‰æ‹©)
- [æ–¹æ¡ˆä¸€ï¼šRailway å¿«é€Ÿéƒ¨ç½²](#-æ–¹æ¡ˆä¸€railwayæ¨è--æœ€ç®€å•)
- [æ–¹æ¡ˆäºŒï¼šVercel + Railway åˆ†ç¦»éƒ¨ç½²](#-æ–¹æ¡ˆäºŒvercelå‰ç«¯-railwayåç«¯)
- [æ–¹æ¡ˆä¸‰ï¼šè‡ªæ‰˜ç®¡æœåŠ¡å™¨ + Docker Compose](#-æ–¹æ¡ˆä¸‰docker-compose--äº‘æœåŠ¡å™¨)
- [AI æœåŠ¡éƒ¨ç½²ï¼šn8n å·¥ä½œæµ](#-ai-æœåŠ¡éƒ¨ç½²n8n-å·¥ä½œæµ)
- [AI æœåŠ¡éƒ¨ç½²ï¼šOpen WebUI](#-ai-æœåŠ¡éƒ¨ç½²open-webui)
- [IoT æœåŠ¡éƒ¨ç½²](#-iot-æœåŠ¡éƒ¨ç½²)
- [ç«¯å£æš´éœ²ä¸åå‘ä»£ç†](#-ç«¯å£æš´éœ²ä¸åå‘ä»£ç†é…ç½®)
- [æ•°æ®åº“è‡ªåŠ¨åˆå§‹åŒ–](#-æ•°æ®åº“è‡ªåŠ¨åˆå§‹åŒ–æœºåˆ¶)
- [GitHub Actions è‡ªåŠ¨éƒ¨ç½²](#-github-actions-è‡ªåŠ¨éƒ¨ç½²)
- [æˆæœ¬ä¼°ç®—](#-æˆæœ¬ä¼°ç®—)
- [éƒ¨ç½²æ£€æŸ¥æ¸…å•](#-éƒ¨ç½²æ£€æŸ¥æ¸…å•)
- [ğŸ‡¨ğŸ‡³ é˜¿é‡Œäº‘ ECS ä¸“é¡¹éƒ¨ç½²æ–¹æ¡ˆ](ALIBABA_ECS_DEPLOYMENT.md)

---

## ğŸ“Š é¡¹ç›®æ¶æ„åˆ†æ

### æœåŠ¡ç»„ä»¶

| ç»„ä»¶                  | æŠ€æœ¯æ ˆ             | ç«¯å£    | å¿…éœ€ | è¯´æ˜                       |
| --------------------- | ------------------ | ------- | ---- | -------------------------- |
| **å‰ç«¯ (Frontend)**   | Vue 3 + Vite       | 80/443  | âœ…   | é™æ€æ–‡ä»¶ï¼Œéœ€è¦ CDN         |
| **åç«¯ API (Server)** | Node.js + Express  | 3001    | âœ…   | RESTful API                |
| **PostgreSQL**        | PostgreSQL 16 + pg | 5432    | âœ…   | ä¸»æ•°æ®åº“                   |
| **InfluxDB**          | InfluxDB 2.x       | 8086    | âš ï¸   | æ—¶åºæ•°æ®åº“ï¼ˆå¦‚éœ€æ—¶åºæ•°æ®ï¼‰ |
| **n8n**               | n8n                | 5678    | âš ï¸   | AI å·¥ä½œæµè‡ªåŠ¨åŒ–            |
| **Open WebUI**        | Open WebUI         | 3080    | âš ï¸   | AI å¯¹è¯ç•Œé¢                |
| **Node-RED**          | Node-RED           | 1880    | âš ï¸   | IoT æ•°æ®æµå¤„ç†             |
| **Grafana**           | Grafana            | 3000    | âš ï¸   | æ•°æ®å¯è§†åŒ–                 |


### æœåŠ¡æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           äº‘éƒ¨ç½²æ¶æ„                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    Nginx åå‘ä»£ç† (80/443)                        â”‚  â”‚
â”‚  â”‚  / â†’ å‰ç«¯  â”‚  /api/* â†’ API  â”‚  /n8n/* â†’ n8n  â”‚  /ai/* â†’ WebUI   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚         â–¼                          â–¼                          â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   å‰ç«¯      â”‚            â”‚   åç«¯ API  â”‚            â”‚ PostgreSQL  â”‚  â”‚
â”‚  â”‚  (é™æ€æ–‡ä»¶) â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  (Node.js)  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  (æ ¸å¿ƒæ•°æ®) â”‚  â”‚
â”‚  â”‚             â”‚            â”‚   :3001     â”‚            â”‚   :5432     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚         â–¼                          â–¼                          â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   n8n       â”‚            â”‚ Open WebUI  â”‚            â”‚  InfluxDB   â”‚  â”‚
â”‚  â”‚ (AI å·¥ä½œæµ) â”‚            â”‚ (AI å¯¹è¯)   â”‚            â”‚ (æ—¶åºæ•°æ®)  â”‚  â”‚
â”‚  â”‚   :5678     â”‚            â”‚   :8080     â”‚            â”‚   :8086     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Node-RED   â”‚            â”‚   Grafana   â”‚            â”‚             â”‚  â”‚
â”‚  â”‚ (IoT æ•°æ®)  â”‚            â”‚ (å¯è§†åŒ–)    â”‚            â”‚             â”‚  â”‚
â”‚  â”‚   :1880     â”‚            â”‚   :3000     â”‚            â”‚             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

```
ä¼ æ„Ÿå™¨/è®¾å¤‡ â†’ Node-RED â†’ InfluxDB (æ—¶åºæ•°æ®)
                 â†“
ç”¨æˆ· â†’ Nginx â†’ å‰ç«¯é™æ€æ–‡ä»¶
         â†“
      API Server â† â†’ PostgreSQL (ç»“æ„åŒ–æ•°æ®)
         â†“
      n8n (AI åˆ†æ) â†’ Open WebUI (Gemini API)
```

---

## âš ï¸ é‡è¦ï¼šæ•°æ®è¿ç§»è¯´æ˜

> **æœ¬åœ° Docker ä¸­çš„æ•°æ®ï¼ˆPostgreSQLã€InfluxDBï¼‰ä¸ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°äº‘ç«¯ï¼**

Docker volumes ä¸­çš„æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°æœºå™¨ä¸Šï¼Œéƒ¨ç½²ä»£ç åˆ°äº‘ç«¯æ—¶ï¼š
- äº‘ç«¯æ•°æ®åº“æ˜¯**ç©ºçš„**
- éœ€è¦**è‡ªåŠ¨åˆå§‹åŒ–**æ•°æ®åº“ç»“æ„ï¼ˆå·²é…ç½®ï¼‰
- å¦‚éœ€è¿ç§»ç°æœ‰æ•°æ®ï¼Œéœ€è¦**æ‰‹åŠ¨å¯¼å‡º/å¯¼å…¥**

### æ•°æ®è¿ç§»æ–¹æ¡ˆ

#### PostgreSQL æ•°æ®å¯¼å‡º/å¯¼å…¥

```bash
# 1. å¯¼å‡ºæœ¬åœ°æ•°æ®
docker exec twinsight-postgres pg_dump -U postgres twinsight > backup.sql

# 2. ä¸Šä¼ åˆ°äº‘ç«¯æœåŠ¡å™¨åå¯¼å…¥
# Railway: ä½¿ç”¨ Railway CLI
railway run psql $DATABASE_URL < backup.sql

# æˆ–ç›´æ¥è¿æ¥è¿œç¨‹æ•°æ®åº“
psql "postgresql://user:pass@host:5432/twinsight" < backup.sql
```

#### InfluxDB æ•°æ®å¯¼å‡º/å¯¼å…¥

```bash
# 1. å¯¼å‡ºæœ¬åœ°æ•°æ®
docker exec twinsight-influxdb influx backup /tmp/backup --token YOUR_TOKEN
docker cp twinsight-influxdb:/tmp/backup ./influx_backup

# 2. å¯¼å…¥åˆ°äº‘ç«¯ InfluxDB
# éœ€è¦å…ˆè®¾ç½®è¿œç¨‹è¿æ¥ï¼Œæˆ–ä½¿ç”¨ InfluxDB Cloud çš„å¯¼å…¥åŠŸèƒ½
```

#### æ¨èåšæ³•

| åœºæ™¯ | å»ºè®® |
|------|------|
| **å¼€å‘/æµ‹è¯•** | ä¸è¿ç§»æ•°æ®ï¼Œå®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆå§‹åŒ–ç©ºæ•°æ®åº“ |
| **ç”Ÿäº§ç¯å¢ƒ** | ä½¿ç”¨ä¸Šè¿°å¯¼å‡º/å¯¼å…¥å‘½ä»¤è¿ç§»æ•°æ® |
| **æ—¶åºæ•°æ®** | ä½¿ç”¨ InfluxDB Cloudï¼Œé€šè¿‡ Node-RED æŒç»­å†™å…¥ |


## ğŸ“¦ é…ç½®ä¸æ•°æ®è¿ç§»æŒ‡å—

é™¤äº†æ•°æ®åº“æ•°æ®ï¼Œå„ä¸ªæœåŠ¡çš„**é…ç½®**ï¼ˆå¦‚ AI å·¥ä½œæµã€IoT æµç¨‹å›¾ï¼‰ä¹Ÿéœ€è¦è¿ç§»åˆ°äº‘ç«¯ç¯å¢ƒã€‚

### 1. n8n å·¥ä½œæµè¿ç§»

n8n çš„å·¥ä½œæµå­˜å‚¨åœ¨ SQLite æ•°æ®åº“ä¸­ï¼ˆé»˜è®¤æƒ…å†µï¼‰ï¼Œæœ€ç®€å•çš„è¿ç§»æ–¹å¼æ˜¯**å¯¼å‡º/å¯¼å…¥ JSON**ã€‚

#### å¯¼å‡ºï¼ˆæœ¬åœ°ï¼‰
1. æ‰“å¼€æœ¬åœ° n8n ç•Œé¢ (`http://localhost:5678`)ã€‚
2. è¿›å…¥ **Workflows** åˆ—è¡¨ã€‚
3. é€‰æ‹©è¦è¿ç§»çš„å·¥ä½œæµ -> ç‚¹å‡»å³ä¸Šè§’èœå• -> **Download**ã€‚
4. ä¿å­˜ä¸º `.json` æ–‡ä»¶ã€‚
5. **å‡­è¯ (Credentials)**ï¼š
   - n8n æä¾›äº†å¯¼å‡ºå‡­è¯çš„åŠŸèƒ½ï¼ˆCLIï¼‰ï¼Œä½†åœ¨äº‘ç«¯é‡æ–°è¾“å…¥ API Key é€šå¸¸æ›´å®‰å…¨ä¸”ä¸å®¹æ˜“å‡ºé”™ã€‚
   - å»ºè®®åœ¨ Railway çš„ n8n æœåŠ¡ä¸­é‡æ–°å½•å…¥ `Gemini API Key` å’Œ `Postgres` è¿æ¥ä¿¡æ¯ã€‚

#### å¯¼å…¥ï¼ˆRailwayï¼‰
1. æ‰“å¼€éƒ¨ç½²å¥½çš„ Railway n8n åœ°å€ (`https://twinsight-n8n.up.railway.app`)ã€‚
2. åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·ç™»å½•ã€‚
3. ç‚¹å‡»å³ä¸Šè§’ **Import from File**ã€‚
4. é€‰æ‹©ä¹‹å‰å¯¼å‡ºçš„ `.json` æ–‡ä»¶ã€‚
5. æ‰“å¼€å¯¼å…¥çš„å·¥ä½œæµï¼Œæ£€æŸ¥èŠ‚ç‚¹é…ç½®ï¼ˆç‰¹åˆ«æ˜¯æ•°æ®åº“è¿æ¥èŠ‚ç‚¹ï¼‰ï¼Œç¡®ä¿å‡­è¯å·²æ­£ç¡®ç»‘å®šã€‚

### 2. Open WebUI è¿ç§»

Open WebUI ä¸»è¦ä¾èµ–**ç¯å¢ƒå˜é‡**é…ç½®ï¼ŒèŠå¤©è®°å½•å»ºè®®é‡æ–°å¼€å§‹æˆ–ä½¿ç”¨å†…ç½®å¯¼å‡ºåŠŸèƒ½ã€‚

#### é…ç½®è¿ç§»
è¯·ç¡®ä¿å°†æœ¬åœ° `docker-compose.yml` ä¸­çš„å…³é”®ç¯å¢ƒå˜é‡å¤åˆ¶åˆ° Railway æœåŠ¡å˜é‡ä¸­ï¼š
- `OPENAI_API_BASE_URLS`
- `OPENAI_API_KEYS` (å³ Gemini API Key)
- `ENABLE_RAG_WEB_SEARCH`

#### æ•°æ®è¿ç§»ï¼ˆèŠå¤©è®°å½•ï¼‰
1. **æœ¬åœ°**ï¼šç‚¹å‡»å·¦ä¸‹è§’å¤´åƒ -> **Settings** -> **Account** -> **Export All Data** (å¯¼å‡ºæ‰€æœ‰æ•°æ®)ã€‚
2. **äº‘ç«¯**ï¼šç™»å½• Railway éƒ¨ç½²çš„ Open WebUI -> **Settings** -> **Account** -> **Import Data**ã€‚
   > **æ³¨æ„**ï¼šå¦‚æœä¸ä¿ç•™å†å²å¯¹è¯ï¼Œç›´æ¥åœ¨äº‘ç«¯åˆ›å»ºæ–°è´¦å·ä½¿ç”¨å³å¯ã€‚

### 3. Node-RED è¿ç§»

Node-RED çš„æ ¸å¿ƒæ˜¯ `flows.json` æ–‡ä»¶ã€‚

#### å¯¼å‡ºï¼ˆæœ¬åœ°ï¼‰
1. æ‰“å¼€æœ¬åœ° Node-RED (`http://localhost:1880`)ã€‚
2. ç‚¹å‡»å³ä¸Šè§’èœå• (ä¸‰æ¨ªçº¿) -> **Export**ã€‚
3. é€‰æ‹© **All flows** (æ‰€æœ‰æµç¨‹)ã€‚
4. ç‚¹å‡» **Download** ä¿å­˜ä¸º `.json` æ–‡ä»¶ã€‚

#### å¯¼å…¥ï¼ˆäº‘ç«¯/VPSï¼‰
1. æ‰“å¼€äº‘ç«¯ Node-REDã€‚
2. ç‚¹å‡»å³ä¸Šè§’èœå• -> **Import**ã€‚
3. é€‰æ‹©å¯¼å‡ºçš„ `.json` æ–‡ä»¶ã€‚
4. ç‚¹å‡» **Import**ã€‚
5. **æ£€æŸ¥èŠ‚ç‚¹é…ç½®**ï¼š
   - ç‰¹åˆ«æ³¨æ„ **InfluxDB Out** èŠ‚ç‚¹å’Œ **TCP/MQTT** èŠ‚ç‚¹ã€‚
   - ç¡®ä¿ InfluxDB è¿æ¥é…ç½®å·²æ›´æ–°ä¸ºäº‘ç«¯åœ°å€ï¼ˆæˆ– Railway å†…éƒ¨åœ°å€ï¼‰ã€‚
6. ç‚¹å‡»å³ä¸Šè§’ **Deploy** ç”Ÿæ•ˆã€‚

---

## ğŸš€ è¿›é˜¶ï¼šä¸ºå®¢æˆ·å®ç°ä¸€é”®éƒ¨ç½²

å¦‚æœæ‚¨å°†æ¥éœ€è¦ä¸ºå®¢æˆ·äº¤ä»˜è¿™å¥—ç³»ç»Ÿï¼Œæœ€ä¼˜é›…çš„æ–¹å¼æ˜¯æä¾›**ä¸€é”®éƒ¨ç½² (One-Click Deploy)**ã€‚

### æ–¹æ¡ˆä¸€ï¼šRailway Templates (æ¨è)

Railway å…è®¸æ‚¨å°†æ•´ä¸ªé¡¹ç›®é…ç½®ï¼ˆåŒ…å«æ‰€æœ‰æœåŠ¡ã€å˜é‡è¿æ¥ã€å¯åŠ¨å‘½ä»¤ï¼‰æ‰“åŒ…æˆä¸€ä¸ªæ¨¡æ¿é“¾æ¥ã€‚

#### åˆ¶ä½œæ­¥éª¤
1. **å®Œå–„å½“å‰é¡¹ç›®**ï¼š
   - ç¡®ä¿æ‚¨çš„ Railway é¡¹ç›®ä¸­åŒ…å«äº†æ‰€æœ‰éœ€è¦çš„æœåŠ¡ï¼ˆTwinsight App, Postgres, N8N, Open WebUI ç­‰ï¼‰ã€‚
   - ç¡®ä¿æ‰€æœ‰æœåŠ¡ä¹‹é—´çš„è¿æ¥ï¼ˆé€šè¿‡å˜é‡ï¼‰éƒ½å·²é…ç½®æ­£ç¡®ä¸”è¿è¡Œæ­£å¸¸ã€‚

2. **ç”Ÿæˆæ¨¡æ¿**ï¼š
   - åœ¨ Railway é¡¹ç›®ç•Œé¢ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ **Settings** (è®¾ç½®)ã€‚
   - æ‰¾åˆ° **Template** åŒºåŸŸï¼Œç‚¹å‡» **Generate Template**ã€‚
   - å¡«å†™æ¨¡æ¿åç§°ï¼ˆå¦‚ `Twinsight AI Solution`ï¼‰å’Œæè¿°ã€‚

3. **è·å–éƒ¨ç½²é“¾æ¥**ï¼š
   - ç”Ÿæˆåï¼Œæ‚¨ä¼šè·å¾—ä¸€ä¸ªç±»ä¼¼ `https://railway.app/template/xxxx` çš„é“¾æ¥ã€‚
   - æˆ–è€…ç”Ÿæˆä¸€ä¸ª Markdown æŒ‰é’®ä»£ç ã€‚

#### å®¢æˆ·ä½“éªŒ
å®¢æˆ·åªéœ€ç‚¹å‡»æ‚¨æä¾›çš„é“¾æ¥ï¼š
1. è¿™é‡Œä¼šæ˜¾ç¤ºæ‰€æœ‰åŒ…å«çš„æœåŠ¡åˆ—è¡¨ã€‚
2. å®¢æˆ·ç™»å½• GitHub å’Œ Railwayã€‚
3. **å…³é”®ç‚¹**ï¼šRailway ä¼šè‡ªåŠ¨æç¤ºå®¢æˆ·è¾“å…¥å¿…è¦çš„å˜é‡ï¼ˆå¦‚ API Keysï¼‰ï¼Œè€Œåƒæ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²è¿™ç§å†…éƒ¨å˜é‡ä¼šè‡ªåŠ¨å¤„ç†ã€‚
4. ç‚¹å‡»éƒ¨ç½²ï¼Œå‡ åˆ†é’Ÿåä¸€å¥—å®Œæ•´çš„ç§æœ‰ç¯å¢ƒå°±æ­å»ºå®Œæˆäº†ã€‚

### æ–¹æ¡ˆäºŒï¼šVPS ä¸€é”®å®‰è£…è„šæœ¬

å¯¹äºæ‹¥æœ‰è‡ªå·±æœåŠ¡å™¨çš„å®¢æˆ·ï¼Œå¯ä»¥å°è£…ä¸€ä¸ª Shell è„šæœ¬ã€‚

#### åˆ¶ä½œ `install.sh`
```bash
#!/bin/bash
# Tandem ä¸€é”®éƒ¨ç½²è„šæœ¬

echo "å¼€å§‹éƒ¨ç½² Twinsight..."

# 1. æ£€æŸ¥ Docker
if ! command -v docker &> /dev/null; then
    echo "å®‰è£… Docker..."
    curl -fsSL https://get.docker.com | sh
fi

# 2. ä¸‹è½½ä»£ç 
git clone https://github.com/ideeinfo/twinsight.git /opt/twinsight
cd /opt/twinsight/docker

# 3. è¯¢é—®é…ç½®
read -p "è¯·è¾“å…¥ Gemini API Key: " api_key
sed -i "s/your-gemini-key/$api_key/g" .env.production.example
cp .env.production.example .env

# 4. å¯åŠ¨
docker-compose -f docker-compose.prod.yml up -d

echo "éƒ¨ç½²å®Œæˆï¼è®¿é—® http://localhost å³å¯ä½¿ç”¨ã€‚"
```

---

## ğŸ¯ éƒ¨ç½²ç­–ç•¥é€‰æ‹©

### æ¨èæ–¹æ¡ˆå¯¹æ¯”

| æœåŠ¡å•†               | å¤æ‚åº¦  | æœˆè´¹ä¼°ç®— | Docker æ”¯æŒ | å…¨æœåŠ¡æ ˆ | æ¨èåœºæ™¯          |
| -------------------- | ------- | -------- | ----------- | -------- | ----------------- |
| **Railway** â­       | ğŸŸ¢ ç®€å• | $5-20    | âœ… å®Œæ•´     | âœ… æ˜¯    | å¿«é€ŸåŸå‹/å°å›¢é˜Ÿ   |
| **Render**           | ğŸŸ¢ ç®€å• | $0-25    | âœ… å®Œæ•´     | âœ… æ˜¯    | ä¸ªäººé¡¹ç›®/æ¼”ç¤º     |
| **Fly.io**           | ğŸŸ¡ ä¸­ç­‰ | $5-30    | âœ… å®Œæ•´     | âœ… æ˜¯    | å…¨çƒè¾¹ç¼˜éƒ¨ç½²      |
| **Vercel + Railway** | ğŸŸ¡ ä¸­ç­‰ | $0-20    | ğŸ”¶ éƒ¨åˆ†     | ğŸ”¶ æ‹†åˆ†  | å‰ç«¯ä¼˜å…ˆé¡¹ç›®      |
| **Google Cloud Run** | ğŸŸ¢ ç®€å• | æŒ‰ç”¨é‡   | âœ… å®Œæ•´     | ğŸ”¶ éƒ¨åˆ†  | æ— æœåŠ¡å™¨/æŒ‰éœ€æ‰©å±• |
| **AWS ECS + RDS**    | ğŸ”´ å¤æ‚ | $50-200+ | âœ… å®Œæ•´     | âœ… æ˜¯    | ä¼ä¸šç”Ÿäº§ç¯å¢ƒ      |
| **è‡ªæ‰˜ç®¡ VPS**       | ğŸ”´ å¤æ‚ | $10-50   | âœ… å®Œæ•´     | âœ… æ˜¯    | å®Œå…¨æ§åˆ¶/å…¨æœåŠ¡   |

### åˆ†å±‚éƒ¨ç½²ç­–ç•¥å»ºè®®

ç”±äºé¡¹ç›®åŒ…å«å¤šä¸ªæœåŠ¡ï¼Œå»ºè®®é‡‡ç”¨**åˆ†å±‚éƒ¨ç½²**ï¼š

| å±‚çº§           | æœåŠ¡                          | æ¨èå¹³å°            | ç†ç”±                   |
| -------------- | ----------------------------- | ------------------- | ---------------------- |
| **æ ¸å¿ƒåº”ç”¨å±‚** | å‰ç«¯ + åç«¯ + PostgreSQL      | Railway / Cloud Run | è‡ªåŠ¨ CI/CDï¼Œæ‰˜ç®¡æ•°æ®åº“ |
| **AI æœåŠ¡å±‚**  | n8n + Open WebUI              | Railway æˆ– ç‹¬ç«‹ VPS | å¯é€‰éƒ¨ç½²ï¼Œèµ„æºçµæ´»     |
| **IoT/ç›‘æ§å±‚** | InfluxDB + Node-RED + Grafana | ç‹¬ç«‹ VPS æˆ–äº‘æ‰˜ç®¡   | æŒä¹…åŒ–æ•°æ®ï¼Œé«˜å¯ç”¨     |

---

## ğŸš€ æ–¹æ¡ˆä¸€ï¼šRailwayï¼ˆæ¨è - æœ€ç®€å•ï¼‰

Railway æ”¯æŒç›´æ¥ä» GitHub éƒ¨ç½²ï¼Œè‡ªåŠ¨æ£€æµ‹é¡¹ç›®ç±»å‹å¹¶é…ç½®ã€‚

### å·²é…ç½®æ–‡ä»¶

é¡¹ç›®å·²åŒ…å«ä»¥ä¸‹ Railway é…ç½®ï¼š

- `Dockerfile` - å¤šé˜¶æ®µæ„å»ºï¼ŒåŒ…å«å‰ç«¯å’Œåç«¯
- `railway.json` - Railway éƒ¨ç½²é…ç½®
- `docker/entrypoint.sh` - å®¹å™¨å¯åŠ¨è„šæœ¬ï¼Œæ”¯æŒè‡ªåŠ¨æ•°æ®åº“åˆå§‹åŒ–

### railway.json é…ç½®

```json
{
    "$schema": "https://railway.app/railway.schema.json",
    "build": {
        "builder": "DOCKERFILE",
        "dockerfilePath": "Dockerfile"
    },
    "deploy": {
        "startCommand": "node scripts/post-deploy.js && node index.js",
        "healthcheckPath": "/api/health",
        "healthcheckTimeout": 60,
        "restartPolicyType": "ON_FAILURE",
        "restartPolicyMaxRetries": 5,
        "numReplicas": 1
    }
}
```

### éƒ¨ç½²æµç¨‹

1. **è®¿é—® [railway.app](https://railway.app)** â†’ ç”¨ GitHub ç™»å½•
2. **New Project** â†’ **Deploy from GitHub Repo**
3. **é€‰æ‹© `ideeinfo/twinsight` ä»“åº“**
4. **æ·»åŠ  PostgreSQL**ï¼š
   - ç‚¹å‡» **Add Service** â†’ **Database** â†’ **PostgreSQL**
   - Railway ä¼šè‡ªåŠ¨æ³¨å…¥ `DATABASE_URL` ç¯å¢ƒå˜é‡
5. **é…ç½®ç¯å¢ƒå˜é‡**ï¼š
   ```
   NODE_ENV=production
   DATABASE_URL=${{Postgres.DATABASE_URL}}  # è‡ªåŠ¨å¡«å……
   SERVER_PORT=3001
   # Gemini APIï¼ˆå¦‚éœ€ AI åŠŸèƒ½ï¼‰
   GEMINI_API_KEY=your-gemini-api-key
   # InfluxDBï¼ˆå¦‚æœéœ€è¦ï¼‰
   INFLUX_URL=https://your-influxdb-cloud.com
   INFLUX_ORG=your-org
   INFLUX_BUCKET=twinsight
   INFLUX_TOKEN=your-token
   ```
6. **éƒ¨ç½²**ï¼šç‚¹å‡» **Deploy** å³å¯

### é…ç½®è‡ªå®šä¹‰åŸŸå

1. åœ¨ Railway é¡¹ç›®è®¾ç½®ä¸­ï¼Œç‚¹å‡» **Settings** â†’ **Domains**
2. æ·»åŠ è‡ªå®šä¹‰åŸŸåæˆ–ä½¿ç”¨ Railway æä¾›çš„ `*.up.railway.app`

---

## ğŸš€ æ–¹æ¡ˆäºŒï¼šVercelï¼ˆå‰ç«¯ï¼‰+ Railwayï¼ˆåç«¯ï¼‰

### å‰ç«¯éƒ¨ç½²ï¼ˆVercelï¼‰

1. **è®¿é—® [vercel.com](https://vercel.com)** â†’ GitHub ç™»å½•
2. **Import Project** â†’ é€‰æ‹©ä»“åº“
3. **é…ç½®**ï¼š
   - Framework: **Vite**
   - Build Command: `npm run build`
   - Output Directory: `dist`
4. **ç¯å¢ƒå˜é‡**ï¼š
   ```
   VITE_API_URL=https://your-railway-backend.up.railway.app
   VITE_INFLUX_URL=https://your-influxdb-cloud.com
   VITE_INFLUX_ORG=your-org
   VITE_INFLUX_BUCKET=twinsight
   VITE_INFLUX_TOKEN=your-token
   ```

### åç«¯éƒ¨ç½²ï¼ˆRailwayï¼‰

åŒæ–¹æ¡ˆä¸€çš„æ­¥éª¤ï¼Œä½†åªéƒ¨ç½² `server` ç›®å½•ã€‚

---

## ğŸš€ æ–¹æ¡ˆä¸‰ï¼šDocker Compose + äº‘æœåŠ¡å™¨

é€‚ç”¨äºéœ€è¦å®Œå…¨æ§åˆ¶çš„åœºæ™¯ï¼ˆAWS EC2ã€é˜¿é‡Œäº‘ ECSã€è…¾è®¯äº‘ CVMï¼‰ã€‚

### é…ç½®æ–‡ä»¶

é¡¹ç›®å·²åŒ…å«ç”Ÿäº§ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `docker/docker-compose.prod.yml` | ç”Ÿäº§ç¯å¢ƒå®Œæ•´æœåŠ¡æ ˆ |
| `docker/nginx.conf` | Nginx åå‘ä»£ç†é…ç½® |
| `docker/.env.production.example` | ç¯å¢ƒå˜é‡æ¨¡æ¿ |
| `docker/entrypoint.sh` | å®¹å™¨å¯åŠ¨è„šæœ¬ |

### éƒ¨ç½²æ­¥éª¤

#### 1. å‡†å¤‡æœåŠ¡å™¨

```bash
# å®‰è£… Docker å’Œ Docker Compose
curl -fsSL https://get.docker.com | sh
sudo usermod -aG docker $USER

# å…‹éš†ä»£ç 
git clone https://github.com/ideeinfo/twinsight.git /opt/twinsight
cd /opt/twinsight
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
cd docker
cp .env.production.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œå¡«å†™å®é™…é…ç½®
nano .env
```

#### 3. é…ç½® SSL è¯ä¹¦

```bash
# åˆ›å»º SSL ç›®å½•
mkdir -p docker/ssl

# ä½¿ç”¨ Let's Encryptï¼ˆæ¨èï¼‰
sudo apt install certbot
sudo certbot certonly --standalone -d your-domain.com

# å¤åˆ¶è¯ä¹¦
sudo cp /etc/letsencrypt/live/your-domain.com/fullchain.pem docker/ssl/
sudo cp /etc/letsencrypt/live/your-domain.com/privkey.pem docker/ssl/
```

#### 4. å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨æ ¸å¿ƒæœåŠ¡
docker-compose -f docker-compose.prod.yml up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.prod.yml logs -f

# åœæ­¢æœåŠ¡
docker-compose -f docker-compose.prod.yml down
```

---

## ğŸ¤– AI æœåŠ¡éƒ¨ç½²ï¼šn8n å·¥ä½œæµ

n8n æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥ä½œæµè‡ªåŠ¨åŒ–å¹³å°ï¼Œç”¨äºå¤„ç† AI åˆ†æä»»åŠ¡ã€‚

### Railway éƒ¨ç½² n8n

1. åœ¨ Railway é¡¹ç›®ä¸­æ·»åŠ æ–°æœåŠ¡
2. é€‰æ‹© **Docker Image** â†’ `n8nio/n8n:latest`
3. é…ç½®ç¯å¢ƒå˜é‡ï¼š
   ```
   N8N_HOST=0.0.0.0
   N8N_PORT=5678
   N8N_PROTOCOL=https
   WEBHOOK_URL=https://your-n8n-domain/
   N8N_BASIC_AUTH_ACTIVE=true
   N8N_BASIC_AUTH_USER=admin
   N8N_BASIC_AUTH_PASSWORD=your-password
   GEMINI_API_KEY=your-gemini-api-key
   N8N_BLOCK_ENV_ACCESS_IN_NODE=false
   TZ=Asia/Shanghai
   ```
4. æš´éœ²ç«¯å£ `5678`
5. é…ç½®æŒä¹…åŒ–å­˜å‚¨å· `/home/node/.n8n`

### è‡ªæ‰˜ç®¡éƒ¨ç½² n8n

ä½¿ç”¨ `docker/docker-compose.prod.yml` ä¸­å·²åŒ…å« n8n é…ç½®ï¼š

```yaml
n8n:
  image: n8nio/n8n:latest
  container_name: twinsight-n8n
  restart: unless-stopped
  environment:
    - N8N_HOST=${N8N_HOST:-localhost}
    - N8N_PORT=5678
    - GEMINI_API_KEY=${GEMINI_API_KEY}
    # ... æ›´å¤šé…ç½®
  volumes:
    - n8n_data:/home/node/.n8n
```

### å¯¼å…¥å·¥ä½œæµ

é¡¹ç›®ä¸­çš„ n8n å·¥ä½œæµä½äº `n8n-workflows/` ç›®å½•ï¼Œéƒ¨ç½²åå¯é€šè¿‡ n8n ç•Œé¢å¯¼å…¥ã€‚

---

## ğŸ¤– AI æœåŠ¡éƒ¨ç½²ï¼šOpen WebUI

Open WebUI æä¾›ç±»ä¼¼ ChatGPT çš„ AI å¯¹è¯ç•Œé¢ï¼Œæ”¯æŒ Gemini APIã€‚

### Railway éƒ¨ç½² Open WebUI

1. åœ¨ Railway é¡¹ç›®ä¸­æ·»åŠ æ–°æœåŠ¡
2. é€‰æ‹© **Docker Image** â†’ `ghcr.io/open-webui/open-webui:main`
3. é…ç½®ç¯å¢ƒå˜é‡ï¼š
   ```
   WEBUI_NAME=Twinsight AI
   DEFAULT_LOCALE=zh-CN
   ENABLE_API_KEYS=true
   OPENAI_API_BASE_URLS=https://generativelanguage.googleapis.com/v1beta/openai
   OPENAI_API_KEYS=your-gemini-api-key
   ENABLE_SIGNUP=false
   ENABLE_RAG_WEB_SEARCH=true
   HF_ENDPOINT=https://hf-mirror.com
   ```
4. æš´éœ²ç«¯å£ `8080`
5. é…ç½®æŒä¹…åŒ–å­˜å‚¨å· `/app/backend/data`

### è‡ªæ‰˜ç®¡éƒ¨ç½² Open WebUI

ä½¿ç”¨ `docker/docker-compose.prod.yml` ä¸­å·²åŒ…å« Open WebUI é…ç½®ã€‚

---

## ğŸ“¡ IoT æœåŠ¡éƒ¨ç½²

### InfluxDB äº‘æœåŠ¡æ–¹æ¡ˆ

æ¨èä½¿ç”¨ **InfluxDB Cloud**ï¼ˆå…è´¹å±‚æ”¯æŒ 30 å¤©æ•°æ®ä¿ç•™ï¼‰ï¼š

1. è®¿é—® [cloud2.influxdata.com](https://cloud2.influxdata.com)
2. æ³¨å†Œå…è´¹è´¦æˆ·
3. åˆ›å»º Bucketï¼š`twinsight`
4. è·å– API Token
5. é…ç½®ç¯å¢ƒå˜é‡

### Node-RED éƒ¨ç½²

Node-RED ç”¨äº IoT æ•°æ®é‡‡é›†å’Œå¤„ç†ã€‚æ¨èä¸å®Œæ•´æœåŠ¡æ ˆä¸€èµ·éƒ¨ç½²åœ¨è‡ªæ‰˜ç®¡æœåŠ¡å™¨ä¸Šã€‚

### Grafana éƒ¨ç½²

Grafana ç”¨äºæ•°æ®å¯è§†åŒ–ä»ªè¡¨ç›˜ã€‚å¯ä½¿ç”¨ï¼š
- **Grafana Cloud** - å…è´¹å±‚è¶³å¤Ÿå°å‹é¡¹ç›®ä½¿ç”¨
- **è‡ªæ‰˜ç®¡** - ä½¿ç”¨ `docker-compose.prod.yml` é…ç½®

---

## ğŸŒ ç«¯å£æš´éœ²ä¸åå‘ä»£ç†é…ç½®

### Nginx ç»Ÿä¸€ç«¯å£æ˜ å°„

ä½¿ç”¨ `docker/nginx.conf` é…ç½®ï¼Œé€šè¿‡ Nginx åå‘ä»£ç†ç»Ÿä¸€æš´éœ²æ‰€æœ‰æœåŠ¡ï¼š

| è·¯å¾„ | ç›®æ ‡æœåŠ¡ | è¯´æ˜ |
|------|----------|------|
| `/` | å‰ç«¯é™æ€æ–‡ä»¶ | Vue åº”ç”¨ |
| `/api/*` | åç«¯ API (:3001) | RESTful API |
| `/n8n/*` | n8n (:5678) | AI å·¥ä½œæµ |
| `/ai/*` | Open WebUI (:8080) | AI å¯¹è¯ |
| `/nodered/*` | Node-RED (:1880) | IoT æ•°æ®æµ |
| `/grafana/*` | Grafana (:3000) | ç›‘æ§ä»ªè¡¨ç›˜ |
| `/webhook/*` | n8n Webhook | å¤–éƒ¨ Webhook æ¥å…¥ |

### é…ç½®ç¤ºä¾‹

```nginx
# API ä»£ç†
location /api/ {
    proxy_pass http://api:3001/api/;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
}

# n8n å·¥ä½œæµ
location /n8n/ {
    proxy_pass http://n8n:5678/;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
}

# Open WebUI
location /ai/ {
    proxy_pass http://open-webui:8080/;
    proxy_buffering off;  # æ”¯æŒæµå¼å“åº”
}
```

### Railway ç«¯å£æš´éœ²

Railway è‡ªåŠ¨å¤„ç†ç«¯å£æš´éœ²ï¼Œæ¯ä¸ªæœåŠ¡è·å¾—ç‹¬ç«‹åŸŸåï¼š
- ä¸»åº”ç”¨ï¼š`twinsight.up.railway.app`
- n8nï¼š`twinsight-n8n.up.railway.app`
- Open WebUIï¼š`twinsight-ai.up.railway.app`

---

## ğŸ”§ æ•°æ®åº“è‡ªåŠ¨åˆå§‹åŒ–æœºåˆ¶

### åˆå§‹åŒ–è„šæœ¬

é¡¹ç›®åŒ…å« `server/scripts/post-deploy.js` è„šæœ¬ï¼Œåœ¨å®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰§è¡Œï¼š

1. **ç­‰å¾…æ•°æ®åº“å°±ç»ª** - æœ€å¤šé‡è¯• 30 æ¬¡
2. **æ£€æŸ¥è¡¨ç»“æ„** - åˆ¤æ–­æ˜¯å¦éœ€è¦åˆå§‹åŒ–
3. **åˆ›å»ºè¡¨ç»“æ„** - æ‰§è¡Œ `db/schema.sql`
4. **åˆ›å»ºåŸºç¡€æ•°æ®** - åˆ›å»ºç³»ç»Ÿå¿…éœ€çš„åˆå§‹æ•°æ®

### å·¥ä½œåŸç†

```javascript
// å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œ
async function main() {
    // 1. ç­‰å¾…æ•°æ®åº“å°±ç»ª
    await waitForDatabase();
    
    // 2. æ£€æŸ¥å¹¶åˆå§‹åŒ–æ•°æ®åº“ç»“æ„
    await initializeDatabase();
    
    // 3. å¯åŠ¨åº”ç”¨
    console.log('âœ… åˆå§‹åŒ–å®Œæˆï¼Œå‡†å¤‡å¯åŠ¨åº”ç”¨');
}
```

### é…ç½®è¦ç‚¹

- **å¹‚ç­‰æ‰§è¡Œ**ï¼šè„šæœ¬å¯é‡å¤æ‰§è¡Œï¼Œä¸ä¼šæŠ¥é”™
- **è‡ªåŠ¨æ£€æµ‹**ï¼šä»…åœ¨è¡¨ä¸å­˜åœ¨æ—¶åˆ›å»º
- **ç¯å¢ƒå˜é‡**ï¼šæ”¯æŒ `DATABASE_URL` æˆ–ç‹¬ç«‹é…ç½®

---

## ğŸ”§ GitHub Actions è‡ªåŠ¨éƒ¨ç½²

### å·²é…ç½®å·¥ä½œæµ

`.github/workflows/deploy.yml` æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼š

| éƒ¨ç½²ç›®æ ‡    | è§¦å‘æ¡ä»¶            | è¯´æ˜         |
| ----------- | ------------------- | ------------ |
| **Railway** | æ¨é€åˆ° main/db åˆ†æ”¯ | è‡ªåŠ¨éƒ¨ç½²     |
| **Vercel**  | æ‰‹åŠ¨è§¦å‘            | å‰ç«¯éƒ¨ç½²     |
| **SSH**     | æ‰‹åŠ¨è§¦å‘            | è‡ªæ‰˜ç®¡æœåŠ¡å™¨ |
| **Docker**  | æ‰‹åŠ¨è§¦å‘            | ä»…æ„å»ºé•œåƒ   |

### é…ç½® GitHub Secrets

åœ¨ä»“åº“ **Settings** â†’ **Secrets and variables** â†’ **Actions** ä¸­æ·»åŠ ï¼š

| Secret åç§°          | è¯´æ˜            | å¿…éœ€ |
| -------------------- | --------------- | ---- |
| `RAILWAY_TOKEN`      | Railway API Token | âœ…  |
| `VITE_API_URL`       | åç«¯ API åœ°å€   | âœ…   |
| `VITE_INFLUX_URL`    | InfluxDB åœ°å€   | âš ï¸   |
| `VITE_INFLUX_ORG`    | InfluxDB ç»„ç»‡   | âš ï¸   |
| `VITE_INFLUX_BUCKET` | InfluxDB Bucket | âš ï¸   |
| `VITE_INFLUX_TOKEN`  | InfluxDB Token  | âš ï¸   |
| `SSH_HOST`           | SSH æœåŠ¡å™¨åœ°å€  | âš ï¸   |
| `SSH_USERNAME`       | SSH ç”¨æˆ·å      | âš ï¸   |
| `SSH_PRIVATE_KEY`    | SSH ç§é’¥        | âš ï¸   |
| `VERCEL_TOKEN`       | Vercel Token    | âš ï¸   |
| `VERCEL_ORG_ID`      | Vercel ç»„ç»‡ ID  | âš ï¸   |
| `VERCEL_PROJECT_ID`  | Vercel é¡¹ç›® ID  | âš ï¸   |

### æ‰‹åŠ¨è§¦å‘éƒ¨ç½²

1. è®¿é—®ä»“åº“çš„ **Actions** æ ‡ç­¾é¡µ
2. é€‰æ‹© **Deploy to Cloud** å·¥ä½œæµ
3. ç‚¹å‡» **Run workflow**
4. é€‰æ‹©éƒ¨ç½²ç›®æ ‡ï¼ˆrailway/vercel/ssh/dockerï¼‰
5. ç‚¹å‡» **Run workflow** å¼€å§‹éƒ¨ç½²

---

## ğŸ’° æˆæœ¬ä¼°ç®—

### å°å‹é¡¹ç›®ï¼ˆ< 1000 ç”¨æˆ·/æœˆï¼‰
| æœåŠ¡                       | æœˆè´¹         |
| -------------------------- | ------------ |
| Railway (API + PostgreSQL) | $5-10        |
| Vercel (å‰ç«¯)              | å…è´¹         |
| InfluxDB Cloud             | å…è´¹å±‚       |
| **æ€»è®¡**                   | **$5-10/æœˆ** |

### ä¸­å‹é¡¹ç›®ï¼ˆ1000-10000 ç”¨æˆ·/æœˆï¼‰
| æœåŠ¡                  | æœˆè´¹       |
| --------------------- | ---------- |
| Railway Pro           | $20        |
| PostgreSQL (æ›´å¤§å­˜å‚¨) | +$10       |
| InfluxDB Cloud ä»˜è´¹   | $25        |
| n8n (Railway)         | +$5        |
| Open WebUI (Railway)  | +$5        |
| **æ€»è®¡**              | **$65/æœˆ** |

### ä¼ä¸šçº§ï¼ˆ> 10000 ç”¨æˆ·/æœˆï¼‰
| æœåŠ¡                  | æœˆè´¹         |
| --------------------- | ------------ |
| è‡ªæ‰˜ç®¡ VPS (4æ ¸8G)    | $50-100      |
| RDS PostgreSQL        | $50-100      |
| InfluxDB Cloud ä¼ä¸šç‰ˆ | $100+        |
| **æ€»è®¡**              | **$200+/æœˆ** |

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

### æ ¸å¿ƒåº”ç”¨
- [ ] ç¯å¢ƒå˜é‡å·²æ­£ç¡®é…ç½®
- [ ] PostgreSQL æ•°æ®åº“å·²è¿æ¥
- [ ] æ•°æ®åº“è¡¨ç»“æ„å·²è‡ªåŠ¨åˆ›å»º
- [ ] å‰ç«¯ `VITE_API_URL` æŒ‡å‘æ­£ç¡®çš„åç«¯åœ°å€
- [ ] CORS å·²é…ç½®å…è®¸å‰ç«¯åŸŸå
- [ ] SSL è¯ä¹¦å·²é…ç½®ï¼ˆHTTPSï¼‰
- [ ] å¥åº·æ£€æŸ¥ç«¯ç‚¹æ­£å¸¸ (`/api/health`)

### AI æœåŠ¡
- [ ] Gemini API Key å·²é…ç½®
- [ ] n8n å·¥ä½œæµå·²å¯¼å…¥
- [ ] Open WebUI ç®¡ç†å‘˜è´¦æˆ·å·²åˆ›å»º
- [ ] Webhook URL å·²é…ç½®

### IoT æœåŠ¡
- [ ] InfluxDB å·²è¿æ¥
- [ ] Node-RED æ•°æ®æµå·²é…ç½®
- [ ] Grafana ä»ªè¡¨ç›˜å·²åˆ›å»º

### è¿ç»´
- [ ] æ—¥å¿—æ”¶é›†å·²é…ç½®
- [ ] ç›‘æ§å‘Šè­¦å·²é…ç½®
- [ ] å¤‡ä»½ç­–ç•¥å·²åˆ¶å®š

---

## ğŸ”— æœ‰ç”¨é“¾æ¥

- [Railway æ–‡æ¡£](https://docs.railway.app)
- [Vercel æ–‡æ¡£](https://vercel.com/docs)
- [Fly.io æ–‡æ¡£](https://fly.io/docs)
- [InfluxDB Cloud](https://www.influxdata.com/products/influxdb-cloud/)
- [n8n æ–‡æ¡£](https://docs.n8n.io/)
- [Open WebUI æ–‡æ¡£](https://docs.openwebui.com/)
- [Let's Encrypt](https://letsencrypt.org/)
