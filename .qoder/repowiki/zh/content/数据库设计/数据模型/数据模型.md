# 数据模型

<cite>
**本文档引用的文件**  
- [schema.sql](file://server/db/schema.sql)
- [init-all.sql](file://server/db/init-all.sql)
- [asset.js](file://server/models/asset.js)
- [space.js](file://server/models/space.js)
- [document.js](file://server/models/document.js)
- [user.js](file://server/models/user.js)
- [view.js](file://server/models/view.js)
- [mapping-config.js](file://server/models/mapping-config.js)
- [influx-config.js](file://server/models/influx-config.js)
- [classification.js](file://server/models/classification.js)
- [model-file.js](file://server/models/model-file.js)
- [document-exif.js](file://server/models/document-exif.js)
- [index.js](file://server/db/index.js)
</cite>

## 目录
1. [核心实体关系图（ERD）](#核心实体关系图erd)
2. [核心表结构详解](#核心表结构详解)
3. [Sequelize模型与数据库映射](#sequelize模型与数据库映射)
4. [数据完整性与业务规则](#数据完整性与业务规则)
5. [总结](#总结)

## 核心实体关系图（ERD）

```mermaid
erDiagram
model_files ||--o{ assets : "1:N"
model_files ||--o{ spaces : "1:N"
model_files ||--o{ asset_specs : "1:N"
model_files ||--o{ classifications : "1:N"
model_files ||--o{ views : "1:N"
model_files ||--o{ influx_configs : "1:1"
model_files ||--o{ mapping_configs : "1:N"
model_files ||--o{ knowledge_bases : "1:1"
assets }o--|| asset_specs : "spec_code"
assets }o--|| documents : "asset_code"
assets }o--|| classifications : "classification_code"
spaces }o--|| documents : "space_code"
spaces }o--|| classifications : "classification_code"
asset_specs }o--|| documents : "spec_code"
views }o--|| documents : "view_id"
documents }o--|| document_exif : "1:1"
documents }o--|| kb_documents : "N:N"
views {
int id PK
int file_id FK
varchar(255) name
text thumbnail
jsonb camera_state
jsonb isolation_state
jsonb selection_state
jsonb theming_state
varchar(100) environment
jsonb cutplanes
double precision explode_scale
jsonb render_options
jsonb other_settings
jsonb viewer_state
bool is_default
timestamp created_at
timestamp updated_at
}
documents {
int id PK
varchar(255) title
varchar(255) file_name
varchar(500) file_path
int file_size
varchar(50) file_type
varchar(100) mime_type
varchar(100) asset_code FK
varchar(100) space_code FK
varchar(100) spec_code FK
int view_id FK
varchar(255) openwebui_file_id
timestamp created_at
timestamp updated_at
}
document_exif {
int id PK
int document_id FK
timestamp date_time
int image_width
int image_height
varchar(255) equip_model
numeric(5,2) f_number
varchar(50) exposure_time
int iso_speed
numeric(10,2) focal_length
numeric(12,8) gps_longitude
numeric(11,8) gps_latitude
numeric(10,2) gps_altitude
timestamp created_at
timestamp updated_at
}
kb_documents {
uuid id PK
uuid kb_id FK
int document_id FK
varchar(255) openwebui_kb_id
varchar(255) openwebui_file_id
varchar(20) sync_status
text sync_error
timestamp synced_at
timestamp created_at
}
knowledge_bases {
uuid id PK
int file_id FK
varchar(255) openwebui_kb_id
varchar(255) kb_name
timestamp created_at
timestamp updated_at
}
mapping_configs {
int id PK
int file_id FK
varchar(50) config_type
varchar(100) field_name
varchar(200) category
varchar(200) property
timestamp created_at
timestamp updated_at
}
influx_configs {
int id PK
int file_id FK
varchar(500) influx_url
int influx_port
varchar(200) influx_org
varchar(200) influx_bucket
text influx_token
varchar(200) influx_user
text influx_password
bool use_basic_auth
bool is_enabled
timestamp created_at
timestamp updated_at
}
views {
int id PK
int file_id FK
varchar(255) name
text thumbnail
jsonb camera_state
jsonb isolation_state
jsonb selection_state
jsonb theming_state
varchar(100) environment
jsonb cutplanes
double precision explode_scale
jsonb render_options
jsonb other_settings
jsonb viewer_state
bool is_default
timestamp created_at
timestamp updated_at
}
assets {
int id PK
uuid uuid
int file_id FK
varchar(100) asset_code
varchar(100) spec_code FK
varchar(200) name
varchar(100) floor
varchar(200) room
int db_id
timestamp created_at
timestamp updated_at
}
spaces {
int id PK
uuid uuid
int file_id FK
varchar(100) space_code
varchar(200) name
varchar(100) classification_code FK
varchar(500) classification_desc
varchar(100) floor
decimal(15,4) area
decimal(15,4) perimeter
int db_id
timestamp created_at
timestamp updated_at
}
asset_specs {
int id PK
uuid uuid
int file_id FK
varchar(100) spec_code
varchar(200) spec_name
varchar(100) classification_code
varchar(500) classification_desc
varchar(200) category
varchar(200) family
varchar(200) type
varchar(200) manufacturer
varchar(500) address
varchar(50) phone
timestamp created_at
timestamp updated_at
}
classifications {
int id PK
varchar(100) classification_code
varchar(500) classification_desc
varchar(20) classification_type
timestamp created_at
timestamp updated_at
}
model_files {
int id PK
varchar(100) file_code
varchar(200) title
varchar(500) original_name
varchar(1000) file_path
bigint file_size
varchar(20) status
bool is_active
varchar(1000) extracted_path
timestamp created_at
timestamp updated_at
}
```

**图示来源**
- [init-all.sql](file://server/db/init-all.sql#L18-L388)
- [schema.sql](file://server/db/schema.sql#L6-L202)

## 核心表结构详解

### 资产表 (assets)
存储资产构件的基本信息，以MC编码作为唯一标识。

| 字段名 | 数据类型 | 主键 | 外键 | 非空 | 默认值 | 说明 |
|--------|----------|------|------|------|--------|------|
| id | SERIAL | 是 | 否 | 是 | 无 | 自增主键 |
| uuid | UUID | 否 | 否 | 是 | gen_random_uuid() | 全局唯一标识符 |
| file_id | INTEGER | 否 | 是 | 是 | 无 | 关联的模型文件ID，级联删除 |
| asset_code | VARCHAR(100) | 否 | 否 | 是 | 无 | 资产编码（MC编码），非空 |
| spec_code | VARCHAR(100) | 否 | 否 | 否 | 无 | 规格编码，引用资产规格表 |
| name | VARCHAR(200) | 否 | 否 | 否 | 无 | 资产名称 |
| floor | VARCHAR(100) | 否 | 否 | 否 | 无 | 所在楼层 |
| room | VARCHAR(200) | 否 | 否 | 否 | 无 | 所在房间 |
| db_id | INTEGER | 否 | 否 | 否 | 无 | Viewer中的dbId |
| created_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 更新时间 |

**表级约束**:
- 唯一约束：`(file_id, asset_code)` 确保同一模型文件内资产编码唯一
- 外键约束：`file_id` 引用 `model_files(id)`，删除时级联删除
- 索引：`idx_assets_uuid` (uuid), `idx_assets_spec_code` (spec_code), `idx_assets_floor` (floor), `idx_assets_room` (room), `idx_assets_db_id` (db_id)

**图示来源**
- [schema.sql](file://server/db/schema.sql#L39-L54)

### 空间表 (spaces)
存储房间构件的基本信息。

| 字段名 | 数据类型 | 主键 | 外键 | 非空 | 默认值 | 说明 |
|--------|----------|------|------|------|--------|------|
| id | SERIAL | 是 | 否 | 是 | 无 | 自增主键 |
| uuid | UUID | 否 | 否 | 是 | gen_random_uuid() | 全局唯一标识符 |
| file_id | INTEGER | 否 | 是 | 是 | 无 | 关联的模型文件ID，级联删除 |
| space_code | VARCHAR(100) | 否 | 否 | 是 | 无 | 空间编码，非空 |
| name | VARCHAR(200) | 否 | 否 | 否 | 无 | 空间名称 |
| classification_code | VARCHAR(100) | 否 | 否 | 否 | 无 | 分类编码 |
| classification_desc | VARCHAR(500) | 否 | 否 | 否 | 无 | 分类描述 |
| floor | VARCHAR(100) | 否 | 否 | 否 | 无 | 楼层（标高） |
| area | DECIMAL(15,4) | 否 | 否 | 否 | 无 | 面积 |
| perimeter | DECIMAL(15,4) | 否 | 否 | 否 | 无 | 周长 |
| db_id | INTEGER | 否 | 否 | 否 | 无 | Viewer中的dbId |
| created_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 更新时间 |

**表级约束**:
- 唯一约束：`(file_id, space_code)` 确保同一模型文件内空间编码唯一
- 外键约束：`file_id` 引用 `model_files(id)`，删除时级联删除
- 索引：`idx_spaces_uuid` (uuid), `idx_spaces_classification` (classification_code), `idx_spaces_floor` (floor), `idx_spaces_db_id` (db_id)

**图示来源**
- [schema.sql](file://server/db/schema.sql#L56-L73)

### 文档表 (documents)
存储与资产、空间、规格或视图关联的文档信息。

| 字段名 | 数据类型 | 主键 | 外键 | 非空 | 默认值 | 说明 |
|--------|----------|------|------|------|--------|------|
| id | SERIAL | 是 | 否 | 是 | 无 | 自增主键 |
| title | VARCHAR(255) | 否 | 否 | 是 | 无 | 文档标题 |
| file_name | VARCHAR(255) | 否 | 否 | 是 | 无 | 文件名 |
| file_path | VARCHAR(500) | 否 | 否 | 是 | 无 | 文件路径 |
| file_size | INTEGER | 否 | 否 | 否 | 无 | 文件大小（字节） |
| file_type | VARCHAR(50) | 否 | 否 | 否 | 无 | 文件类型（如PDF, IMAGE） |
| mime_type | VARCHAR(100) | 否 | 否 | 否 | 无 | MIME类型 |
| asset_code | VARCHAR(100) | 否 | 否 | 否 | 无 | 关联的资产编码 |
| space_code | VARCHAR(100) | 否 | 否 | 否 | 无 | 关联的空间编码 |
| spec_code | VARCHAR(100) | 否 | 否 | 否 | 无 | 关联的规格编码 |
| view_id | INTEGER | 否 | 是 | 否 | 无 | 关联的视图ID，删除时置空 |
| openwebui_file_id | VARCHAR(255) | 否 | 否 | 否 | 无 | OpenWebUI文件ID |
| created_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 更新时间 |

**表级约束**:
- 外键约束：`view_id` 引用 `views(id)`，删除时置空（SET NULL）
- 索引：`idx_documents_asset` (asset_code), `idx_documents_space` (space_code), `idx_documents_spec` (spec_code), `idx_documents_created` (created_at DESC)

**图示来源**
- [init-all.sql](file://server/db/init-all.sql#L185-L209)

### 用户表 (users)
存储系统用户信息，支持邮箱密码和第三方身份认证。

| 字段名 | 数据类型 | 主键 | 外键 | 非空 | 默认值 | 说明 |
|--------|----------|------|------|------|--------|------|
| id | SERIAL | 是 | 否 | 是 | 无 | 自增主键 |
| email | VARCHAR(255) | 否 | 否 | 是 | 无 | 邮箱，唯一 |
| password_hash | TEXT | 否 | 否 | 是 | 无 | 密码哈希值 |
| name | VARCHAR(100) | 否 | 否 | 是 | 无 | 用户名 |
| avatar_url | TEXT | 否 | 否 | 否 | 无 | 头像URL |
| is_active | BOOLEAN | 否 | 否 | 否 | TRUE | 是否激活 |
| last_login_at | TIMESTAMP | 否 | 否 | 否 | 无 | 最后登录时间 |
| created_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 更新时间 |

**关联表**:
- `user_roles`: 用户角色表，多对多关系
- `user_identities`: 用户身份表，存储第三方登录信息
- `refresh_tokens`: 刷新令牌表，用于保持登录状态

**图示来源**
- [user.js](file://server/models/user.js#L1-L252)

### 视图表 (views)
存储模型的视图状态，包括相机、隔离、选择等状态。

| 字段名 | 数据类型 | 主键 | 外键 | 非空 | 默认值 | 说明 |
|--------|----------|------|------|------|--------|------|
| id | SERIAL | 是 | 否 | 是 | 无 | 自增主键 |
| file_id | INTEGER | 否 | 是 | 是 | 无 | 关联的模型文件ID，级联删除 |
| name | VARCHAR(255) | 否 | 否 | 是 | 无 | 视图名称 |
| thumbnail | TEXT | 否 | 否 | 否 | 无 | 缩略图URL |
| camera_state | JSONB | 否 | 否 | 否 | 无 | 相机状态 |
| isolation_state | JSONB | 否 | 否 | 否 | 无 | 隔离状态 |
| selection_state | JSONB | 否 | 否 | 否 | 无 | 选择状态 |
| theming_state | JSONB | 否 | 否 | 否 | 无 | 主题状态 |
| environment | VARCHAR(100) | 否 | 否 | 否 | 无 | 环境设置 |
| cutplanes | JSONB | 否 | 否 | 否 | 无 | 剖面设置 |
| explode_scale | DOUBLE PRECISION | 否 | 否 | 否 | 无 | 爆炸比例 |
| render_options | JSONB | 否 | 否 | 否 | 无 | 渲染选项 |
| other_settings | JSONB | 否 | 否 | 否 | 无 | 其他设置 |
| viewer_state | JSONB | 否 | 否 | 否 | 无 | 查看器状态 |
| is_default | BOOLEAN | 否 | 否 | 否 | FALSE | 是否为默认视图 |
| created_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 更新时间 |

**表级约束**:
- 唯一约束：`(file_id, name)` 确保同一模型文件内视图名称唯一
- 外键约束：`file_id` 引用 `model_files(id)`，删除时级联删除
- 索引：`idx_views_file_id` (file_id), `idx_views_name` (name), `idx_views_created` (created_at DESC)

**图示来源**
- [init-all.sql](file://server/db/init-all.sql#L157-L184)

### 映射配置表 (mapping_configs)
存储模型文件的字段映射配置，用于定义数据源字段与系统属性的映射关系。

| 字段名 | 数据类型 | 主键 | 外键 | 非空 | 默认值 | 说明 |
|--------|----------|------|------|------|--------|------|
| id | SERIAL | 是 | 否 | 是 | 无 | 自增主键 |
| file_id | INTEGER | 否 | 是 | 是 | 无 | 关联的模型文件ID，级联删除 |
| config_type | VARCHAR(50) | 否 | 否 | 是 | 无 | 配置类型：'asset', 'asset_spec', 'space' |
| field_name | VARCHAR(100) | 否 | 否 | 是 | 无 | 数据源字段名称 |
| category | VARCHAR(200) | 否 | 否 | 否 | 无 | 系统属性分类 |
| property | VARCHAR(200) | 否 | 否 | 否 | 无 | 系统属性名称 |
| created_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 更新时间 |

**表级约束**:
- 唯一约束：`(file_id, config_type, field_name)` 确保同一文件同一类型的字段名唯一
- 外键约束：`file_id` 引用 `model_files(id)`，删除时级联删除
- 索引：`idx_mapping_configs_file_id` (file_id), `idx_mapping_configs_type` (config_type)

**图示来源**
- [init-all.sql](file://server/db/init-all.sql#L234-L251)
- [create_mapping_config.sql](file://server/db/migrations/create_mapping_config.sql#L1-L29)

### InfluxDB连接配置表 (influx_configs)
存储每个模型的时序数据库连接配置。

| 字段名 | 数据类型 | 主键 | 外键 | 非空 | 默认值 | 说明 |
|--------|----------|------|------|------|--------|------|
| id | SERIAL | 是 | 否 | 是 | 无 | 自增主键 |
| file_id | INTEGER | 否 | 是 | 是 | 无 | 关联的模型文件ID，一对一，级联删除 |
| influx_url | VARCHAR(500) | 否 | 否 | 是 | 无 | InfluxDB服务器地址 |
| influx_port | INTEGER | 否 | 否 | 否 | 8086 | 端口号 |
| influx_org | VARCHAR(200) | 否 | 否 | 是 | 无 | 组织名称 |
| influx_bucket | VARCHAR(200) | 否 | 否 | 是 | 无 | 存储桶名称 |
| influx_token | TEXT | 否 | 否 | 否 | 无 | API Token |
| influx_user | VARCHAR(200) | 否 | 否 | 否 | 无 | 用户名（Basic认证） |
| influx_password | TEXT | 否 | 否 | 否 | 无 | 密码（Basic认证） |
| use_basic_auth | BOOLEAN | 否 | 否 | 否 | FALSE | 是否使用Basic认证 |
| is_enabled | BOOLEAN | 否 | 否 | 否 | TRUE | 是否启用 |
| created_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 创建时间 |
| updated_at | TIMESTAMP | 否 | 否 | 否 | CURRENT_TIMESTAMP | 更新时间 |

**表级约束**:
- 唯一约束：`file_id` 确保每个模型文件只能有一个配置
- 外键约束：`file_id` 引用 `model_files(id)`，删除时级联删除
- 索引：`idx_influx_configs_file_id` (file_id)

**图示来源**
- [schema.sql](file://server/db/schema.sql#L103-L119)

## Sequelize模型与数据库映射

### 资产模型 (asset.js)
资产模型文件定义了与`assets`表交互的数据访问方法。该模型通过直接SQL查询与数据库交互，而非使用Sequelize ORM。模型中的方法如`upsertAsset`、`batchUpsertAssetsWithFile`等，通过参数化查询插入或更新资产数据。`getAssetsByFileId`方法通过LEFT JOIN关联`asset_specs`表，获取资产的规格信息，实现了数据库层面的关联查询。

**关键映射关系**:
- `assetCode` -> `asset_code`
- `specCode` -> `spec_code`
- `fileId` -> `file_id`

**图示来源**
- [asset.js](file://server/models/asset.js#L1-L257)

### 空间模型 (space.js)
空间模型与`spaces`表对应，提供了CRUD操作。`batchUpsertSpacesWithFile`方法在插入新空间前会先删除该文件的所有旧空间，确保数据一致性。模型通过`getSpacesByFileId`等方法支持按文件ID查询，与`model_files`表建立关联。

**关键映射关系**:
- `spaceCode` -> `space_code`
- `classificationCode` -> `classification_code`
- `fileId` -> `file_id`

**图示来源**
- [space.js](file://server/models/space.js#L1-L224)

### 文档模型 (document.js)
文档模型管理`documents`表的访问。`getDocuments`方法根据`assetCode`、`spaceCode`、`specCode`或`viewId`查询关联的文档，体现了文档与多个实体的关联关系。`createDocument`方法插入新文档记录，支持与资产、空间、规格或视图的关联。

**关键映射关系**:
- `fileName` -> `file_name`
- `filePath` -> `file_path`
- `viewId` -> `view_id`

**图示来源**
- [document.js](file://server/models/document.js#L1-L167)

### 用户模型 (user.js)
用户模型实现了用户管理的完整功能，包括创建、查找、更新和角色管理。`setUserRoles`方法通过先删除后插入的方式更新用户角色，确保角色列表的准确性。`findByIdentity`方法通过JOIN查询`user_identities`表，支持第三方身份登录。

**关键映射关系**:
- `passwordHash` -> `password_hash`
- `avatarUrl` -> `avatar_url`
- `lastLoginAt` -> `last_login_at`

**图示来源**
- [user.js](file://server/models/user.js#L1-L252)

### 视图模型 (view.js)
视图模型处理`views`表的CRUD操作。`createView`和`updateView`方法对`viewer_state`和`other_settings`等JSON字段进行序列化后存储。`setDefaultView`方法在设置新默认视图前，会先取消该文件的其他默认视图，确保`is_default`字段的唯一性。

**关键映射关系**:
- `viewerState` -> `viewer_state`
- `otherSettings` -> `other_settings`
- `isDefault` -> `is_default`

**图示来源**
- [view.js](file://server/models/view.js#L1-L245)

### 映射配置模型 (mapping-config.js)
映射配置模型通过`getMappingConfig`和`saveMappingConfig`方法，实现了数据库表与前端配置对象的转换。`getMappingConfig`将数据库记录转换为包含`assetMapping`、`assetSpecMapping`、`spaceMapping`的对象，而`saveMappingConfig`则将对象结构拆解并批量插入数据库。

**关键映射关系**:
- `config.assetMapping` -> `config_type='asset'`
- `config.assetSpecMapping` -> `config_type='asset_spec'`
- `config.spaceMapping` -> `config_type='space'`

**图示来源**
- [mapping-config.js](file://server/models/mapping-config.js#L1-L106)

### InfluxDB配置模型 (influx-config.js)
InfluxDB配置模型提供了对`influx_configs`表的访问。`saveInfluxConfig`方法根据`fileId`是否存在来决定执行INSERT或UPDATE操作。`testInfluxConnection`方法实现了连接测试功能，通过HTTP请求验证InfluxDB服务的可达性。

**关键映射关系**:
- `influxUrl` -> `influx_url`
- `influxOrg` -> `influx_org`
- `influxBucket` -> `influx_bucket`

**图示来源**
- [influx-config.js](file://server/models/influx-config.js#L1-L184)

## 数据完整性与业务规则

### 外键级联删除
数据完整性通过外键约束和级联删除机制保障。当`model_files`表中的记录被删除时，所有关联的子表记录也会被自动删除：
- `assets.file_id` -> `ON DELETE CASCADE`
- `spaces.file_id` -> `ON DELETE CASCADE`
- `asset_specs.file_id` -> `ON DELETE CASCADE`
- `influx_configs.file_id` -> `ON DELETE CASCADE`

这种设计确保了模型文件删除时，其所有相关数据（资产、空间、配置等）都能被彻底清理，避免了孤儿数据的产生。

**图示来源**
- [init-all.sql](file://server/db/init-all.sql#L337-L354)

### 唯一性约束
系统通过唯一性约束防止数据重复：
- `users.email`：确保邮箱地址唯一，是用户登录的主要凭证
- `model_files.file_code`：确保文件编码全局唯一
- `assets(file_id, asset_code)`：确保同一模型文件内资产编码唯一
- `views(file_id, name)`：确保同一模型文件内视图名称唯一

### 业务规则实现
业务规则在模型层通过代码逻辑实现：
- **资产编码格式验证**：虽然数据库层面未强制验证，但`upsertAsset`等方法在插入前会检查`assetCode`是否存在，确保了编码的非空性。业务逻辑上，MC编码应遵循特定格式，此验证应在应用层进行。
- **默认视图互斥**：`setDefaultView`方法通过事务确保同一文件只能有一个默认视图。它先更新该文件所有视图的`is_default`为FALSE，再设置目标视图为TRUE。
- **映射配置原子性**：`saveMappingConfig`方法使用事务处理，先删除旧配置，再插入新配置，保证了配置的完整性和一致性。

**图示来源**
- [view.js](file://server/models/view.js#L191-L219)
- [mapping-config.js](file://server/models/mapping-config.js#L47-L95)

## 总结

TwinSight平台的数据模型围绕`model_files`核心表构建，形成了以资产、空间、文档、视图为主要实体的层次结构。数据库设计充分考虑了数据完整性，通过外键级联删除和唯一性约束保障了数据的一致性。模型层通过直接SQL操作实现了高效的数据库交互，同时在应用逻辑中实现了复杂的业务规则，如默认视图管理、映射配置的原子更新等。整个数据架构支持了平台的核心功能，包括BIM模型数据管理、文档关联、时序数据集成和用户权限控制。

**图示来源**
- [schema.sql](file://server/db/schema.sql)
- [init-all.sql](file://server/db/init-all.sql)
- [server/models/](file://server/models/)